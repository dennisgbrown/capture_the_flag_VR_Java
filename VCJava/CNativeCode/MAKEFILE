# Makefile for the C code for 
# VCJava -- dynamically loaded native C library for java

CC      = cc
LD	= /usr/bin/ld

######################################################################
# Locations that are environment specific.
######################################################################

JAVAHOME=/tmp_mnt/net/buzzard/dewan/brownde/CosmoCode/usr/java
VCLIB = ./VCOLLIDE/lib/libVCollide.a ./VCOLLIDE/RAPID/libRAPID.a
MATHLIB = -lm
C++LIB = -lC

######################################################################
# end of location specifications -- the rest of this file should not
# need to be changed
######################################################################

# subdirectory to put the c stubs generated by JAVAH
CLASSSTUBDIR = ../CClassStubs
# subdirectory to put the C header files produced by JAVAH
CHEADERDIR  = ../CClassHeaders

# locations necessary for C builds
JAVAIRIXINC  = $(JAVAHOME)/include/irix
JAVASHAREINC    = $(JAVAHOME)/include
JDK_INCLUDE_DIR = $(JDK_HOME)/include

INCLUDES    = -I. -I$(CHEADERDIR) -I$(JAVASHAREINC) -I$(JAVAIRIXINC) \
 -I./VCOLLIDE/include
CFLAGS      = $(INCLUDES) -c

# location of the StubPreamble.h file necessary to get data from java
# classes
STUBPREAMBLE    = $(JAVASHAREINC)/StubPreamble.h

# name of the shared library we will create (under Irix)
LIBRARY = libVCJava.so

# make library to make the damn library already
library: $(LIBRARY)

libstubs.o: libstubs.c
	$(CC) $(CFLAGS) libstubs.c

VCJava_funcs.o: VCJava_funcs.c
	$(CC) $(CFLAGS) VCJava_funcs.c

# making the library will create the .so shared library to be loaded in at
# runtime
$(LIBRARY): libstubs.o VCJava_funcs.o
	$(LD) -shared -o ../$(LIBRARY) libstubs.o VCJava_funcs.o $(VCLIB) $(C++LIB) $(MATHLIB)

library: $(LIBRARY)

# clean out the *.o files and machine generated files from javah
clean:
	rm -f *.o libstubs.c $(LIBRARY)



















